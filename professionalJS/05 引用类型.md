# 05 引用类型

引用类型的值（对象）是引用类型的一个实例。在ECMAScript中，引用类型是一种数据结构，用于将数据和功能组织在一起。它也常被称为类。

尽管ECMAScript从技术上讲是一门面向对象的语言，但是它不具备传统的面向对象语言所支持的类和接口等基本结构。引用类型有时候也被称为对象定义，因为它们描述的是一类对象所具有的属性和方法。

虽然引用类型与类看起来相似，但它们并不是相同的概念。

对象是某个特定引用类型的实例。新对象是使用new操作符后跟一个构造函数来创建的。构造函数本身就是一个函数，只不过该函数是出于创建新对象的目的而定义的。

例如：

```javascript
var person = new Object();
```

这行代码创建了object引用类型的一个新实例，然后把该实例保存在了变量person中。使用的构造函数是Object，它只为新对象定义了默认的属性和方法。

## 5.1 Object类型

虽然Object实例不具备多少功能，但是对于在应用程序中存储和传输数据而言，它们的确是非常理想的选择。

创建Object实例的方式有两种。

- 使用new操作符后跟Object构造函数；

```javascript
var person = new Object();
person.name = "song";
person.age = 18;
```

- 对象字面量表示法。对象字面量是对象定义的一种简写形式，目的在于简化创建包含大量属性的对象的过程。

```javascript
var person = {
  name: "song",
  age: 18
};
```

使用对象字面量的语法时，如果留空气花括号，则可以定义只包含默认属性和方法的对象，例如：

```javascript
var person = {}; // 与new Object()相同
person.name  = "song";
person.age = 18;
```

在通过对象字面量定义对象时，实际上不会调用Object构造函数。

一般来说，访问对象属性时使用的都是点表示法，这也是很多面向对象语言中通用的语法。不过，在Js也可以使用方括号来表示法来访问对象的属性。

```javascript
person["name"];
person.name;
```

从功能上看，这两种访问对象属性的方法没有任何区别。但方括号法的主要优点时可以通过变量来访问属性。

如果属性名中包含会导致语法错误的字符，或者属性名使用的是关键字或保留字，也可以使用方括号表示法。属性名中可以包含非字母非数字。

## 5.2 Array类型

ECMAScript数组与其他语言中的数组都是数据的有序列表，不同的是ECMAScript数组的每一项都可以保存任何类型的数据。

创建数组的方式有两种：

- 使用Array构造函数；

```javascript
var colors = new Array();
```

​	如果预先知道数组项目的数量，也可以给构造函数传递该数量。

```javascript
var colors = new Array(7);
```

​	也可以向Array构造函数中传递数组中应该包含的项。

```javascript
var colors = new Array('red', 'blue','green');
```

- 使用数组字面量表示法。

### 5.2.1 检测数组

- instanceof 

缺点：它假定单一的全局执行环境。如果网页中包含多个框架，实际上就存在两个以上不同的全局执行环境，从而存在两个以上不同版本的Array构造函数，如果从一个框架向另一个框架传入一个数组，那么传入的数组与在第二个框架中原生创建的数组分别具有各自不同的构造函数。

于是有了：

- Array.isArray()：最终确定某个值到底是不是数组，而不管它是在哪个全局执行环境中创建的。

### 5.2.2 转换方法

toLocaleString()；

toString()；

valueOf()；

join()；

### 5.2.3 栈方法

push()；

pop()；// 返回数组的最后一项

### 5.2.4 队列方法

shift()；

unshift()；

### 5.2.5 重排序方法

reverse()；

sort()；

### 5.2.6 操作方法

concat()；

slice()；

splice()；

### 5.2.7 位置方法

indexOf()；

lastIndexOf()；

### 5.2.8 迭代方法

ECMAScript为数组定义了5个迭代方法：每个方法都接收两个参数：要在每一项上运行的函数和运行该函数的作用域对象——影响this的值。

传入这些方法中的函数会接收三个参数：数组项的值、该项在数组中的位置和数组对象本身。

every()；

filter()；

forEach()；

map()；

some()；

### 5.2.9 缩小方法

reduce()；

reduceRight()；

## 5.3 Date 类型

创建一个日期对象，使用new操作符和Date构造函数即可。

```javascript
var now = new Date();
```

Date.parse()；

Date.UTC()；

### 5.3.1 继承的方法 

toString()；

toLocaleString()；

valueof()；

### 5.3.2 日期格式转化法

toDateString()；

toTimeString()；

toLocaleDateString()；

toLocaleTimeString()；

toUTCString()；

### 5.3.3 日期／时间组件方法

很多很多，具体需要的时候再查吧。

## 5.4 RegExp类型

ECMAScript通过RegExp类型来支持正则表达式。

语法:

```javascript
var expression = / pattern / flags;
```

其中pattern部分可以是任何简单或复杂的正则表达式，可以包含字符类、限定符、分组、向前查找以及反向引用。每个正则表达式都可带有一或多个标志（flags），用以标明正则表达式的行为。

正则表达式的匹配模式支持下列3个标志：

- g：表示全局模式，即模式将被应用于所有字符串，而非在发现第一个匹配项时立即停止；
- i：表示不区分大小写模式，即在确定匹配项时忽略模式与字符串的大小写；
- m：表示多行模式，即在到达一行文本末尾时还会继续查找下一行中是否存在与模式匹配的项。

另一种创建正则表达式的方式是使用RegExp构造函数，它接收两个参数：一个是要匹配的字符串模式，另一个是可选的标志字符串。可以使用字面量定义的任何表达式，都可以使用构造函数来定义。

要注意的是：传递给RegExp构造函数的两个参数都是字符串。

使用正则表达式字面量和使用RegExp构造函数创建的正则表达式不一样。es3中，正则表达式字面量始终会共享同一个RegExp实例，而使用构造函数创建的每一个新RegExp实例都是一个新实例。

### 5.4.1 RegExp实例属性

RegExp的每个实例都具有下列属性

- global
- ignoreCase
- lastIndex
- multiline
- source

### 5.4.2 RegExp实例方法

主要方法：exec()；

test()；

继承的呢三个方法，此处省略好多字。

### 5.4.3 RegEx 构造函数属性

![](https://ww1.sinaimg.cn/large/006tKfTcgy1fdhq7cgdekj30ul07xwh2.jpg)

### 5.4.4 模式的局限性

ECMAScript仍然缺少某些语言所支持的高级正则表达式特性。

## 5.5 Function 类型

函数实际上是对象，每个函数都是Function类型的实例，而且都与其他引用类型一样具有属性和方法。

由于函数是对象，因此函数名实际上也是一个指向函数对象的指针，不会与某个函数绑定。

函数通常是使用函数声明语法定义的。

```javascript
function sum(num1, num2) {
  return num1 + num2;
}
```

使用函数表达式定义函数

```javascript
var sum = function() {
  return num1 + num2;
}；
```

这两种方式几乎相差无几。

使用Function构造函数定义函数，不推荐

由于函数名仅仅是指向函数的指针，因此函数名与包含对象指针的其他变量没有什么不同。换句话说，一个函数可能会有多个名字。

### 5.5.1 没有重载

将函数名想象为指针。在创建第二个函数时，实际上覆盖了引用第一个函数的变量。

### 5.5.2 函数声明与函数表达式

解析器会率先读取函数声明，并使其在执行任何代码之前可用；函数表达式，则必须等到解析器执行到它所在的代码行，才会真正被解释执行。

### 5.5.3 作为值函数

ECMAScript中的函数名本身就是变量，所以函数也可以作为值来使用。也就是说，不仅可以像传递参数一样把一个函数传递给另一个函数，而且可以将一个函数作为另一个函数的结果返回。

还可以从一个函数中返回另一个函数。



















